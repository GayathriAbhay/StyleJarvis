"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["45591"],{307595:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupVideoEndCard_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};r.hash="e04be51b4be0a2585e7803d004fa83b7",t.default=r},60533:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupVideoNonDuplo_pin",selections:[{args:null,kind:"FragmentSpread",name:"CloseupVideoEndCard_pin"},{args:null,kind:"FragmentSpread",name:"VideoWithContextLogging_pin"},{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};r.hash="53ae9ecd15f057f744460205e5d495fd",t.default=r},35312:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinBlock_pin",selections:[{args:null,kind:"FragmentSpread",name:"StoryPinStickerBlockCloseup_pin"}],type:"Pin",abstractKey:null};r.hash="8bb1bb1f7bafeed0fe43bed44ef12d2a",t.default=r},303965:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinStickerBlockCloseup_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};r.hash="7e8d917850c8329247291df0d281a59b",t.default=r},111419:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateImageContainerDimension_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};r.hash="86a6c49cecdb70d77f786a1965756cf9",t.default=r},331047:function(e,t,n){n.r(t);var r,i,o,l,a=(r={alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},l=[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"officialUser",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"firstName",storageKey:null}],storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin",selections:[{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"index",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:[r,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},i,{alias:null,args:null,concreteType:"Domain",kind:"LinkedField",name:"linkDomain",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"UserWebsite",kind:"LinkedField",name:"linkUserWebsite",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"standardPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null});a.hash="b2a27d44d1f3dbd42301b82866212272",t.default=a},707915:function(e,t,n){var r=n(586659),i=n(20256),o=n(601686),l=n(382718);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.Z=(0,r.forwardRef)(function(e,t){var n,s=e.accessibilityLabel,u=e.handleClick,c=e.icon,d=e.iconColor,p=e.iconOnly,f=e.testId,h=e.buttonText,y=e.tabIndex,m=e.bgColor,v=e.isActive,g=function(e){if(Array.isArray(e))return e}(n=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{for(o=(n=n.call(e)).next;!(s=(r=o.call(n)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(n,2)||function(e,t){if(e){if("string"==typeof e)return a(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,2):void 0}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),b=g[0],_=g[1],x=(0,r.useRef)(null);(0,r.useImperativeHandle)(t,function(){return x.current});var P=(0,o.x4)().setAbortNoActionPlacementTimeout,S=function(){_(function(e){return!e}),u(),P(!0)},w=function(e){var t;x&&e.target instanceof Element&&!(null!=(t=x.current)&&t.contains(e.target))&&_(!1)};return(0,r.useEffect)(function(){return window.addEventListener("mousedown",w),function(){window.removeEventListener("mousedown",w)}},[]),(0,r.useEffect)(function(){void 0!==v&&_(v)},[v]),(0,l.jsx)(i.xu,{"data-test-id":f||"closeup-action-bar-button",children:(0,l.jsxs)(i.kC,{alignItems:"center",justifyContent:"start",children:[(0,l.jsx)(i.hU,{ref:x,accessibilityLabel:s,bgColor:m,icon:c,iconColor:d||"darkGray",onClick:S,selected:b,size:p?"md":"lg",tabIndex:y}),h&&(0,l.jsx)(i.iP,{onTap:S,rounding:2,children:(0,l.jsx)(i.X6,{color:"light",overflow:"normal",size:"400",children:h})})]})})})},856782:function(e,t,n){n.d(t,{S:function(){return r}});var r=1e3;t.Z=3},112931:function(e,t,n){n.d(t,{ZP:function(){return m},GJ:function(){return y}});var r,i=n(586659);n(872555);var o=n(592821),l=n(979904),a=n(139707),s=n(974297),u=n(28427),c=n(611499),d=n(601686);function p(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,void 0):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var h=(void 0!==r||(r=n(111419)).hash&&"86a6c49cecdb70d77f786a1965756cf9"!==r.hash&&console.error("The definition of 'useCalculateImageContainerDimension_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function y(e,t){return"".concat(Math.floor(e/t*1e4)/1e4," / 1")}function m(e){var t=e.carouselData,n=e.imageToDisplayWidthRatio,r=void 0===n?1:n,f=e.mainImage,y=void 0===f?{width:1,height:1,url:""}:f,m=e.maxCloseupImageWidth,v=e.pinKey,g=e.shouldPadImage,b=void 0!==g&&g,_=(0,u.Z)(h,v),x=(0,d.x4)(),P=x.peekCloseupEnabled,S=x.viewportSize,w=(0,o.Re)().numericValues,j=(0,l.Z)({pinKey:_}).maxHeight,O=null!=w?w:{},C=O.fiftyPercentHeight,k=O.fiftyPercentWidth,I=O.maxHeight,E=O.maxWidth,A=(0,a.Z)(y).peekRedesignFastFollowsEnabled;return(0,i.useMemo)(function(){var e,n,i,o,l,a,u,d=m-c.d2,f=Math.min(b?d:m,null!=E?E:1/0,null!=k?k:1/0),h=(n=[y].concat(p((null==t||null==(e=t.carousel_slots)?void 0:e.map(function(e){var t,n,r,i,o,l;return(0,s.Z)(e.images)||((n=null==(t=e.videos)?void 0:t.video_list)?null!=(r=n.V_720P)&&r.url?n.V_720P:null!=(i=n.V_HLSV4)&&i.url?n.V_HLSV4:null!=(o=n.V_HLSV3_MOBILE)&&o.url?n.V_HLSV3_MOBILE:null!=(l=n.V_HLSV3_WEB)&&l.url?n.V_HLSV3_WEB:null:null)}).filter(function(e){return!!e}))||[])).map(function(e){var t=e.width,n=e.height;return(null!=t?t:1)/(null!=n?n:1)}),Math.min.apply(Math,p(n))),v=Math.floor(f*(t?r:1)/h),g="sm"===S?C:I;u=P?null!=g?g:v:"number"==typeof j?j:v;var _=A?void 0:u,x=_?Math.min(v,_):v,w=Math.min(f*(P?x/v:1),null!=E?E:1/0,null!=k?k:1/0),O=((l=(null==y?void 0:y.width)/y.height)>(a=w/x)?(i=w,o=w/l):(i=x*l,o=x),{containerAspectRatio:a,letterBoxedWidth:i,letterBoxedHeight:o}),T=O.containerAspectRatio,R=O.letterBoxedWidth,M=O.letterBoxedHeight;return{containerAspectRatio:T,containerHeight:x,containerWidth:w,horizontalOffset:(w-R)/2,letterBoxedHeight:M,letterBoxedWidth:R,letterBoxAspectRatio:R/M,verticalOffset:(x-M)/2}},[m,b,y,t,r,S,C,I,P,j,A,E,k])}},179639:function(e,t,n){n.d(t,{Z:function(){return w}});var r=n(586659),i=n(20256),o=n(592821),l=n(979904),a=n(869985),s=n(980787),u=n(19585),c=n(399806),d=n(218831),p=n(601686),f=n(382718);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){x(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(b=function(){return!!e})()}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,n){return(t=P(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=h(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==h(t)?t:t+""}var S=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&v(o,e);var t,n,r=(t=b(),function(){var e,n=_(o);return e=t?Reflect.construct(n,arguments,_(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==h(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return g(e)}(this,e)});function o(){var e;if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return x(g(e=r.call.apply(r,[this].concat(n))),"startAudiblePlayTime",e.props.muted?null:new Date),e}return n=[{key:"componentDidUpdate",value:function(e){e.muted!==this.props.muted&&(this.startAudiblePlayTime=this.props.muted?null:new Date)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.musicRecordingId,n=e.muted,r=e.pinId,i=e.video;if(t&&!n&&this.startAudiblePlayTime&&Date.now()-this.startAudiblePlayTime.getTime()>=2e3){var o,l,a,s,u,d,p,f=(0,c.Z)({vEXP3:null==(o=i.video_list)?void 0:o.V_EXP3,vEXP4:null==(l=i.video_list)?void 0:l.V_EXP4,vEXP5:null==(a=i.video_list)?void 0:a.V_EXP5,vEXP6:null==(s=i.video_list)?void 0:s.V_EXP6,vEXP7:null==(u=i.video_list)?void 0:u.V_EXP7,v720P:null==(d=i.video_list)?void 0:d.V_720P,vHLSV3MOBILE:null==(p=i.video_list)?void 0:p.V_HLSV3_MOBILE})||{},h=f.hlsv3,y=f.mp4||h,m=(null==y?void 0:y.duration)||0;this.props.logContextEvent({event_type:8999,object_id_str:t,aux_data:{pin_id:r,story_pin_music_duration:m}})}}},{key:"render",value:function(){var e,t,n,r,o,l,s,u,d,p=this.props,h=p.activePageIndex,y=p.aspectRatio,m=p.blockHeight,v=p.blockWidth,g=p.closeupBodyWidth,b=p.closeupStoryPinViewability,_=p.closeupWithinMasonryEnabled,x=p.customEndCard,P=p.isPlaying,S=p.muted,w=p.onEnded,j=p.onUpdateVideoInfo,O=p.pageIndex,C=p.pin,k=p.pinId,I=p.maxHeight,E=p.video,A=p.videoThumbnailStartTime,T=null!=(e=(0,c.Z)({vEXP3:null==(t=E.video_list)?void 0:t.V_EXP3,vEXP4:null==(n=E.video_list)?void 0:n.V_EXP4,vEXP5:null==(r=E.video_list)?void 0:r.V_EXP5,vEXP6:null==(o=E.video_list)?void 0:o.V_EXP6,vEXP7:null==(l=E.video_list)?void 0:l.V_EXP7,v720P:null==(s=E.video_list)?void 0:s.V_720P,vHLSV3MOBILE:null==(u=E.video_list)?void 0:u.V_HLSV3_MOBILE}))?e:{},R=T.hlsv3,M=T.mp4,L=M||R;if(!L)return null;var z=L.height,V=L.thumbnail,F=L.width,D=null!=y?y:(null!=F?F:1)/(null!=z?z:1),B={height:"100%",left:"0",top:"0",width:"100%"},Z=_&&g?(null!=g?g:v)/(null!=(d=Number(I))?d:m):v/m;if(!_&&Math.abs(Z-D)>.01){if(Z<D){var W=100*D/Z;B.width="".concat(W,"%"),B.left="-".concat((W-100)/2,"%")}else if(Z>D){var H=100*Z/D;B.height="".concat(H,"%"),B.top="-".concat((H-100)/2,"%")}}var K="number"==typeof h&&O<=h+3;return(0,f.jsx)(i.xu,{height:"100%",overflow:"hidden",position:"relative",width:"100%",children:(0,f.jsx)(i.xu,{height:"100%",position:"absolute",width:"100%",children:K||P||A?(0,f.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:B},position:"absolute",children:(0,f.jsx)(a.Z,{aspectRatio:_?Z:y,autoplay:P,closeupStoryPinViewability:b,contextLogData:{component:0===O?227:228,element:10957,objectId:k,story_pin_page_id:O,view:3,viewParameter:157},customEndCard:x,customThumbnail:V,isPromoted:!1,loop:!1,muted:S,objectFit:M?_?"contain":"cover":void 0,onEnded:function(){w&&w(O)},onTimeChange:function(e){var t=e.time;j&&"number"==typeof L.duration&&L.duration>0&&j({currentTime:t,duration:L.duration/1e3})},pinId:k,pinKey:null===C?null:{type:"Legacy",data:C},preferMp4:!!M,showControls:"hover",variant:"storyPin",video:{id:E.id,hlsv3:R,mp4:M},videoThumbnailStartTime:A})}):V&&(0,f.jsx)(i.Ee,{alt:this.props.i18n.bt("Video cover image", "Video cover image", "closeup.storyPin.videoCover", undefined, true),fit:"cover",naturalHeight:null!=z?z:1,naturalWidth:null!=F?F:1,src:V})})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,P(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(r.PureComponent);function w(e){var t=(0,s.u)().logContextEvent,n=e.pin,r=(0,u.ZP)(),i=(0,p.x4)().closeupWithinMasonryEnabled,a=(0,d.K)().closeupBodyWidth,c=(0,o.Re)().maxHeight,h=(0,l.Z)({pinKey:null===n?null:{type:"Legacy",data:n}}).maxHeight;return(0,f.jsx)(S,m(m({},e),{},{closeupBodyWidth:a,closeupWithinMasonryEnabled:i,i18n:r,logContextEvent:t,maxHeight:i?h:c}))}},248762:function(e,t,n){n.d(t,{Z:function(){return ec}}),n(492996);var r,i,o=n(20256),l=n(112931),a=n(592821),s=n(963489),u=n(883817),c=n(980787),d=n(886981),p=n(382718),f=function(e){var t=e.block,n=t.block_style,r=(n=void 0===n?{}:n).height,i=n.width,l=n.x_coord,f=n.y_coord,h=n.rotation,y=t.original_comment_id,m=e.horizontalOffset,v=e.pageAspectRatio,g=e.scaleFactor,b=e.verticalOffset,_=(0,c.u)().logContextEvent,x=a._B/v,P=(void 0===i?0:i)*a._B*g/100,S=(void 0===r?0:r)*x*g/100,w=(void 0===l?0:l)*a._B*g/100+(void 0===m?0:m),j=(void 0===f?0:f)*x*g/100+(void 0===b?0:b),O=(0,s.s0)(),C=(0,d.Z)({name:"AggregatedCommentResource",options:{commentId:y,field_set_key:"comment_reply_sticker"}}).data;return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:w,top:j,transform:"rotate(".concat(void 0===h?0:h,"deg)")}},display:"flex",height:S,margin:-1,padding:1,position:"absolute",rounding:2,width:P,zIndex:u.B_,children:(0,p.jsx)(o.iP,{onTap:function(){_({event_type:102,view_type:1,component:227,element:12541,aux_data:{comment_id:y}}),null!=C&&C.pin_id&&O("/pin/".concat(C.pin_id,"/comments/").concat(y||""))},rounding:"pill"})})},h=n(291892),y=n(7525);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var v=["src","fallbackSrc"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=m(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e){var t=e.src,n=e.fallbackSrc,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,v),i=(0,y.Z)(t);return(0,p.jsx)(h.Z,b(b({},r),{},{src:i?t:n}))}var x=n(581722);function P(e){var t=e.isUseCache,n=e.signature;return(0,x.v9)(function(e){var r=e.pinbuilder.storyPinItemBlocks;if(!t)return null;for(var i=0,o=Object.keys(r);i<o.length;i++){var l,a,s=o[i];if((null==(l=r[s].media)?void 0:l.signatureEdited)===n||(null==(a=r[s].media)?void 0:a.signature)===n)return r[s]}return null})}var S=n(586659),w=n(111923),j=n(865540),O=n(982166),C=n(19585),k=n(542092);function I(e,t,n,r,i,o,l){try{var a=e[o](l),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,i)}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var A=function(e){var t,n=e.aggregatedCommentId,r=e.onDismiss,i=(0,C.ZP)(),l=(0,j.Z)(),a=(0,w.Z)(),s=function(e){if(Array.isArray(e))return e}(t=(0,S.useState)(""))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{for(o=(n=n.call(e)).next;!(s=(r=o.call(n)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return E(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),u=s[0],c=s[1],d=(0,p.jsx)(o.kC,{justifyContent:"end",children:(0,p.jsx)(o.zx,{color:"red",disabled:!u,onClick:function(){var e;(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({fromUnifiedComment:!0,objectType:k.o.aggregatedComment,objectId:n,tags:"[]",text:u});case 2:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function l(e){I(o,r,i,l,a,"next",e)}function a(e){I(o,r,i,l,a,"throw",e)}l(void 0)})})(),r()},text:i.bt("Post", "Post", "ideapin.questionsticker.replymodal.postbutton", undefined, true)})});return(0,p.jsx)(O.ZP,{accessibilityModalLabel:"reply to creator Q and A question",align:"start",footer:d,heading:i.bt("Reply", "Reply", "ideapin.questionsticker.replymodal", undefined, true),onDismiss:r,children:(0,p.jsx)(o.xu,{paddingX:8,paddingY:1,children:(0,p.jsx)(o.Kx,{id:"ideaPinQuestionStickerReplyModalTextArea",onChange:function(e){c(e.value)},placeholder:l?i.bt("Your reply will appear as a public comment on this Pin.", "Your reply will show up as a public comment on this Pin.", "pin.questionsticker.replymodal.placeholder", undefined, true):i.bt("Your reply will appear as a public comment on this Idea Pin.", "Your reply will show up as a public comment on this Idea Pin.", "ideapin.questionsticker.replymodal.placeholder", undefined, true),value:u})})})},T=n(744862),R=n(821342),M=n(28427),L=n(302148),z=n(123317),V=n(294711);function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return D(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var B=(void 0!==r||(r=n(303965)).hash&&"7e8d917850c8329247291df0d281a59b"!==r.hash&&console.error("The definition of 'StoryPinStickerBlockCloseup_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function Z(e){var t,n=e.block,r=e.elementType,i=e.horizontalOffset,l=e.onFlyoutOpen,f=e.pageAspectRatio,h=e.pageIndex,y=e.pinKey,m=e.scaleFactor,v=e.tooltipElementType,g=e.verticalOffset,b=e.videoPinProgress,_=(0,c.u)().logContextEvent,x=F((0,S.useState)(!1),2),P=x[0],w=x[1],j=F((0,S.useState)(!1),2),O=j[0],k=j[1],I=(0,S.useRef)(null),E=(0,s.s0)(),D=(0,C.ZP)(),Z=(0,M.Z)(B,y),W=(0,R.Z)(),H=n.block_style,K=(H=void 0===H?{}:H).height,N=H.width,U=H.x_coord,X=H.y_coord,q=H.rotation,G=n.end_time,$=n.error_message,J=n.interactive_sticker_type,Y=void 0===J?null:J,Q=n.is_removed,ee=n.is_valid,et=n.start_time,en=n.sticker_data,er=n.type,ei=null==Z?void 0:Z.entityId,eo=en||{},el=eo.board_id,ea=eo.question_comment_id,es=null!=(t=n.user)?t:{},eu=es.image_small_url,ec=es.full_name,ed=es.username,ep=null,ef=ee&&5===Y&&!!el,eh=ee&&7===Y&&!!ea,ey=(0,d.Z)(el&&ef?{name:"BoardResource",options:{field_set_key:"tagged_board_preview",board_id:el}}:null),em=ey.data||{},ev=em.is_collaborative,eg=em.pin_count,eb=em.url;er===z.h8.PRODUCT_STICKER?ep=ei?"/pin/".concat(ei,"/"):"/":er===z.h8.MENTION_STICKER?ep="/".concat(void 0===ed?"":ed,"/"):ef&&(ep=ey.isLoaded?"".concat(eb):null);var e_=a._B/f,ex=(void 0===N?0:N)*a._B*m/100,eP=(void 0===K?0:K)*e_*m/100,eS=(void 0===U?0:U)*a._B*m/100+(void 0===i?0:i),ew=(void 0===X?0:X)*e_*m/100+(void 0===g?0:g),ej=(b||{}).currentTime,eO=!(0,V.Z)({currentTime:ej,endTime:G,startTime:et}),eC=function(){_({event_type:123,component:228,element:v,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:h}}),w(!1)},ek=function(e){var t=e.event;_({event_type:120,component:228,element:v,view_type:3,view_parameter:157,aux_data:{error_message:!ee&&$?$:null,story_pin_page_id:h}}),w(!0),l&&(t.stopPropagation(),l())};(0,S.useEffect)(function(){return document.addEventListener("scroll",function(){w(!1)}),function(){return document.removeEventListener("scroll",function(){w(!1)})}},[]);var eI=function(){var e=null,t=W.isAuth?null==W?void 0:W.avatar_color_index:void 0;switch(er){case z.h8.PRODUCT_STICKER:var n=Z||{},r=n.gridTitle,i=n.imageSpec_236x,l=n.richSummary,a=n.description,s=l||{},u=s.displayName,c=((s.products||[])[0]||{}).offerSummary||{},d=c||{},f=d.price,h=d.maxPrice,y=!!c&&(!!f||!!h),m=u||r||a;e=(0,p.jsxs)(S.Fragment,{children:[(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(o.zd,{height:40,rounding:3,wash:!0,width:40,children:(null==i?void 0:i.url)&&(0,p.jsx)(o.Ee,{alt:"",color:"lightGray",fit:"cover",naturalHeight:1,naturalWidth:1,src:i.url})})}),(0,p.jsx)(o.xu,{flex:"grow",paddingX:2,children:y?(0,p.jsxs)(o.kC,{alignContent:"center",alignItems:"stretch",direction:"column",flex:"grow",justifyContent:"center",children:[(0,p.jsx)(o.xv,{color:"shopping",lineClamp:1,size:"100",weight:"bold",children:f}),(0,p.jsx)(o.xv,{lineClamp:1,size:"100",children:m})]}):(0,p.jsx)(o.xv,{lineClamp:1,size:"100",children:m})}),(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case z.h8.MENTION_STICKER:e=(0,p.jsxs)(S.Fragment,{children:[(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(T.qE,{color:t,name:null!=ec?ec:"",size:"sm",src:null!=eu?eu:void 0})}),(0,p.jsx)(o.xu,{flex:"grow",paddingX:2,children:(0,p.jsx)(o.xv,{lineClamp:1,size:"200",weight:"bold",children:ec})}),(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case z.h8.GENERIC_STICKER:e=[5].includes(Y)?ee?ey.isLoaded?(0,p.jsxs)(S.Fragment,{children:[(0,p.jsxs)(o.xu,{flex:"grow",paddingX:2,children:[(0,p.jsx)(o.xv,{lineClamp:1,size:"100",weight:"bold",children:ev?D.bt("Explore this group board", "Explore this group board", "closeup.StoryPin.stickerBlock.boardSticker.clickLabel", undefined, true):D.bt("Explore this board", "Explore this board", "closeup.StoryPin.stickerBlock.boardSticker.clickLabel", undefined, true)}),(0,p.jsx)(o.xv,{size:"100",children:(!!eg||0===eg)&&(0,L.nk)(D.nbt(["{{ pinCount }} Pin", "{{ pinCount }} Pins"], eg, "closeup.StoryPin.stickerBlock.boardSticker.boardLabel", true),{pinCount:eg})})]}),(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]}):(0,p.jsxs)(o.xu,{alignItems:"center",direction:"row",display:"flex",flex:"grow",paddingY:2,children:[(0,p.jsx)(o.xu,{marginEnd:1,paddingX:2,children:(0,p.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"100",children:D.bt("Loading board...", "Loading board...", "closeup.StoryPin.stickerBlock.boardSticker.loadingText", undefined, true)})}),(0,p.jsx)(o.xH,{accessibilityLabel:D.bt("Board is loading", "Board is loading", "closeup.StoryPin.stickerBlock.boardSticker.loadingSpinnerText", undefined, true),show:!0,size:"sm"})]}):(0,p.jsx)(o.xu,{paddingX:2,paddingY:2,children:(0,p.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:$})}):(0,p.jsx)(o.xu,{paddingX:2,paddingY:2,children:(0,p.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:D.bt("Sticker not supported yet", "Sticker not supported yet", "closeup.StoryPin.stickerBlock.genericStickerError", undefined, true)})});break;case z.h8.VTO_MAKEUP_STICKER:e=(0,p.jsx)(o.xv,{size:"300",weight:"bold",children:D.bt("Try this sticker on your phone!", "Try this sticker on your phone!", "closeup.storyPin.vtoMakeupSticker", undefined, true)})}return(0,p.jsx)(o.xu,{alignItems:"center","data-test-id":er,display:"flex",justifyContent:"center",padding:er===z.h8.PRODUCT_STICKER?1:3,width:"100%",children:Q?(0,p.jsx)(o.xv,{color:"subtle",size:"200",weight:"bold",children:D.bt("Tag removed.", "Tag removed!", "closeup.storyPin.stickerBlock", undefined, true)}):e})};return(0,p.jsx)(S.Fragment,{children:eO?null:(0,p.jsxs)(o.xu,{ref:I,dangerouslySetInlineStyle:{__style:{left:eS,top:ew,transform:"rotate(".concat(void 0===q?0:q,"deg)")}},"data-test-id":(er||"")+"_container",display:"flex",height:eP+2*a.Xw,margin:-1,padding:1,position:"absolute",rounding:2,width:ex+2*a.Xw,zIndex:u.B_,children:[(0,p.jsx)(o.iP,{disabled:eO,onTap:P?eC:function(e){var t=e.event;eO||(_({event_type:101,component:228,element:r,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:h}}),eh?k(!0):ek({event:t}))},rounding:"pill"}),P&&(0,p.jsx)(o.mh,{zIndex:u.ej,children:(0,p.jsx)(o.J2,{_deprecatedShowCaret:!0,anchor:I.current,idealDirection:"up",onDismiss:eC,positionRelativeToAnchor:!1,size:Q?"flexible":"sm",children:Q?eI():(0,p.jsx)(o.iP,{fullWidth:!0,onTap:function(e){e.event.preventDefault(),Q||(_({event_type:101,component:228,element:v,object_id_str:ei,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:h}}),ep?E(ep):eC())},children:eI()})})}),!!ea&&O&&(0,p.jsx)(A,{aggregatedCommentId:ea,onDismiss:function(){k(!1)}})]})})}var W=n(445698),H=n(47676),K=n(238187),N=n(452750);function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function q(e){var t=e.block,n=e.fontsLoaded,r=e.horizontalOffset,i=e.pageAspectRatio,l=e.scaleFactor,a=e.thumbnail,s=e.verticalOffset,u=t.block_style,c=t.style,d=void 0===c?z.Cc:c,f=t.text,h=d.alignment,y=d.font,m=d.font_size,v=d.highlight_color,g=d.vertical_alignment,b=void 0===g?z.Cc.vertical_alignment:g,_=(null!=d?d:{}).hex_color,x=void 0===_?z.Cc.hex_color:_,P=U((0,S.useState)(0),2),w=P[0],j=P[1],O=U((0,S.useState)([]),2),C=O[0],k=O[1],I=y||z.Cc.font,E=I.name,A=I.default_size,T=I.letter_spacing,R=I.line_height,M=(0,N.Z)(I),L=Math.round(100*((null==u?void 0:u.width)||100))/1e4,V=Math.round(100*((null==u?void 0:u.height)||100))/1e4,F=Math.round(100*((null==u?void 0:u.x_coord)||0))/1e4,D=Math.round(100*((null==u?void 0:u.y_coord)||0))/1e4;(0,S.useEffect)(function(){if(n){var e=(0,K.KV)({text:f,boxHeight:H.q8/i*V,boxWidth:H.q8*L,font:M,startFontSize:Math.floor(m||A||24)});k(e.lines),j(e.fontSize)}},[n,f]);var B=w*l,Z=v?(0,z.pE)(B,R):{x:0,y:0},X=L*H.q8*l+2*Z.x,q=V*(H.q8/i)*l+2*Z.y,G=(void 0===r?0:r)+F*H.q8*l-Z.x,$=a?"".concat(100*D,"%"):(void 0===s?0:s)+D*(H.q8/i)*l-Z.y;return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:G,top:$}},display:"flex",height:q,position:"absolute",width:X,children:(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:(0,W.RK)({alignment:h,verticalAlignment:b})},children:(0,p.jsx)(o.xu,{display:"inlineBlock",maxWidth:"100%",children:(0,p.jsx)("p",{style:(0,W.BN)({fontSize:B,hexColor:x,letterSpacing:T,lineHeight:R,name:E}),children:C.map(function(e,t){return(0,p.jsx)("span",{"data-gestalt-valid-html":"Text",style:(0,W.xm)({fontSize:B,hasText:e.text.length>0,highlightColor:v||null,lineHeight:R}),children:t===C.length-1?e.text:(0,p.jsxs)(S.Fragment,{children:[e.text," ",(0,p.jsx)("br",{})]})},"paragraphLine-".concat(t,"-").concat((null!=f?f:"").substr(0,9)))})})})})})}var G=n(179639);function $(e){var t=e.ownerId,n=(0,C.ZP)(),r=(0,R.Z)(),i=r.isAuth&&r.id===t;return(0,p.jsxs)(o.xu,{alignItems:"center",color:"tertiary",direction:"column",display:"flex",height:"100%",justifyContent:"center",width:"100%",children:[(0,p.jsx)(o.xv,{color:"inverse",children:i?n.bt("Your video is being processed.", "Your video is processing!", "closeup.storyPin.videoPlaceholder", undefined, true):n.bt("This video is still being processed.", "This video is still processing!", "closeup.storyPin.videoPlaceholder", undefined, true)}),(0,p.jsx)(o.xv,{color:"inverse",children:n.bt("Please check back in a few minutes.", "Check back in a few minutes.", "closeup.storyPin.videoPlaceholder", undefined, true)})]})}var J=n(139707),Y=n(934645),Q=n(716920),ee=n(956077),et=n(85574),en=n(601686),er=n(653621);function ei(e){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function el(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eo(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=ei(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ei(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ei(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eo(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ea(e){var t,n,r,i,s,u,c,d,f,y,m,v=e.block,g=e.isActive,b=e.pwtTrackImageLoad,x=e.thumbnail,S=(0,C.ZP)(),w=(0,en.x4)(),j=w.closeupWithinMasonryEnabled,O=w.isCloseupMediaViewerOpen,k=w.peekCloseupEnabled,I=w.showProductDetailPage,E=(0,Y.Z)({showProductDetailPage:I}),A=(x||E?{}:(0,et.Z)({closeupWithinMasonryEnabled:j,peekCloseupEnabled:k})).borderStyle,T=(null==(t=v.image)||null==(n=t.images)?void 0:n["750x"])||(null==(r=v.image)||null==(i=r.images)?void 0:i["474x"]),R=T||{},M=R.height,L=void 0===M?1:M,z=R.width,V=void 0===z?1:z,F=P({isUseCache:!0,signature:v.image_signature}),D=(0,J.Z)(T).peekRedesignFastFollowsEnabled;return T||F?(m=x?"cover":j||D?"none":"contain",(0,p.jsx)(o.xu,{alignItems:k?"center":void 0,dangerouslySetInlineStyle:{__style:el(el({},A),{},{aspectRatio:j?(0,l.GJ)(V,L):void 0,contain:"strict",display:k?"grid":"block",justifySelf:j?"center":void 0})},height:j?"100%":"inherit",overflow:"hidden",width:j?void 0:"inherit",children:F?(0,p.jsx)(_,{_enableViewTransitions:!0,alt:S.bt("Story Pin image", "Story pin image", "closeup.storypin.renderer", undefined, true),color:a.yc,elementTiming:"StoryPinImageBlock-MainPinImage",fallbackSrc:null!=(s=null==(u=F.media)?void 0:u.src)?s:"",fit:m,isActive:g,naturalHeight:L,naturalWidth:V,onLoad:b,src:null!=(c=null==T?void 0:T.url)?c:"",suppressViewTransitionTags:O}):(0,p.jsx)(h.Z,{_enableViewTransitions:!0,alt:S.bt("Story Pin image", "Story pin image", "closeup.storypin.renderer", undefined, true),borderStyle:A,color:a.yc,elementTiming:"StoryPinImageBlock-MainPinImage",fetchPriority:j?"high":void 0,fit:m,isActive:g,naturalHeight:null!=(d=null==T?void 0:T.height)?d:1,naturalWidth:null!=(f=null==T?void 0:T.width)?f:1,onLoad:b,src:null!=(y=null==T?void 0:T.url)?y:"",suppressViewTransitionTags:O})})):null}function es(e){var t,n,r=e.activePageIndex,i=e.block,l=e.closeupStoryPinViewability,s=e.customEndCard,u=e.isActive,c=e.isSplitLayout,d=e.musicRecordingId,f=e.muted,h=e.onEnded,y=e.onUpdateVideoInfo,m=e.ownerId,v=e.pageAspectRatio,g=e.pageDimensions,b=e.pageIndex,_=e.pin,x=e.pinId,S=e.scaleFactor,w=e.stillLoading,j=e.videoThumbnailStartTime,O=e.thumbnail,C=void 0!==O&&O,k=i.block_style,I=(k=void 0===k?{}:k).height,E=void 0===I?100:I,A=k.width,T=void 0===A?100:A,R=k.x_coord,M=void 0===R?0:R,L=k.y_coord,z=void 0===L?0:L,V=i.video,F=(0,en.x4)().closeupWithinMasonryEnabled,D=a._B/v,B=g.height,Z=g.width,W=T*a._B*S/100,H=T<100?Math.min(Math.max(100,T)-Math.abs(M),T):Math.min(Math.max(T-Math.abs(M),0),100),K=E<100?Math.min(Math.max(100,E)-Math.abs(z),E):Math.min(Math.max(E-Math.abs(z),0),100),N=F?"100%":K*D*S/100,U=F?"100%":H*a._B*S/100,X=Math.max(z,0)*D*S/100,q=Math.max(M,0)*a._B*S/100,J=P({isUseCache:!V,signature:i.video_signature});if(w)return null;var Y=(J||{}).media||{},Q=Y.duration,ee=Y.src,et=!!ee&&!!Q;return V||et?!!((null==V||null==(t=V.video_list)?void 0:t.V_HLSV3_MOBILE)||(null==V||null==(n=V.video_list)?void 0:n.V_720P)||et)&&(0,p.jsx)(o.xu,{height:void 0!==c&&c?"50%":"100%",overflow:"hidden",position:"relative",children:(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{alignSelf:"anchor-center",left:q,top:X}},"data-test-id":"story-pin-video-block",height:C?B:N,overflow:"hidden",position:"absolute",width:C?Z:U,children:(0,p.jsx)(G.Z,{activePageIndex:r,aspectRatio:v,blockHeight:C?B:E*D*S/100,blockWidth:C?Z:W,closeupStoryPinViewability:l,customEndCard:s,isPlaying:u,musicRecordingId:d,muted:f,onEnded:h,onUpdateVideoInfo:y,pageIndex:b,pin:_,pinId:x,video:V||{video_list:{V_EXP7:{duration:Q?1e3*Q:0,url:ee}}},videoThumbnailStartTime:j})})}):(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:q,top:X}},height:N,position:"absolute",width:U,children:(0,p.jsx)($,{ownerId:m})})}var eu=(void 0!==i||(i=n(35312)).hash&&"8bb1bb1f7bafeed0fe43bed44ef12d2a"!==i.hash&&console.error("The definition of 'StoryPinBlock_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function ec(e){var t,n=e.activePageIndex,r=e.block,i=e.closeupStoryPinViewability,l=e.customEndCard,s=e.disableProductStickers,u=e.fontsLoaded,c=e.horizontalOffset,d=e.isActive,h=e.isSplitLayout,y=e.musicRecordingId,m=e.muteVideos,v=e.onEnded,g=e.onFlyoutOpen,b=e.onUpdateVideoInfo,_=e.ownerId,x=e.pageAspectRatio,P=e.pageHeight,S=e.pageIndex,w=e.pageWidth,j=e.pin,O=e.pinId,C=e.previewOnly,k=e.pinKey,I=e.stillLoading,E=e.thumbnail,A=void 0!==E&&E,T=e.transform,R=e.verticalOffset,L=e.videoPinProgress,V=e.videoThumbnailStartTime,F=(0,M.Z)(eu,k),D=(0,en.x4)().closeupWithinMasonryEnabled,B=r.block_style,W=(B=void 0===B?{}:B).height,H=void 0===W?100:W,K=B.width,N=void 0===K?100:K,U=B.x_coord,X=B.y_coord,G=r.interactive_sticker_type,$=(0,Q.g)();if(0===H||0===N)return null;var J=w/a._B;switch(r.type){case z.h8.PARAGRAPH:case z.h8.HEADING:return(0,p.jsx)(q,{block:r,fontsLoaded:u,horizontalOffset:c,pageAspectRatio:x,scaleFactor:J,thumbnail:A,verticalOffset:R});case z.h8.VIDEO:return(0,p.jsx)(es,{activePageIndex:n,block:r,closeupStoryPinViewability:i,customEndCard:l,isActive:d,isSplitLayout:void 0!==h&&h,musicRecordingId:y,muted:m,onEnded:v,onUpdateVideoInfo:b,ownerId:_,pageAspectRatio:x,pageDimensions:{height:P,width:w},pageIndex:S,pin:j,pinId:O,scaleFactor:J,stillLoading:void 0!==I&&I,thumbnail:A,videoThumbnailStartTime:V});case z.h8.IMAGE:var Y=T||{},et=Y.scaleX,ei=Y.scaleY;return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{display:D?"grid":"block",height:"".concat(H,"%"),left:"".concat((void 0===U?0:U)*(void 0===et?1:et),"%"),top:"".concat((void 0===X?0:X)*(void 0===ei?1:ei),"%"),width:"".concat(N,"%")}},"data-test-id":"story-pin-image-block",overflow:"hidden",position:"absolute",children:(0,p.jsx)(ea,{block:r,isActive:d,pwtTrackImageLoad:function(){$&&d&&($.addBinaryAnnotation("pin.id",O,"STRING"),$.addBinaryAnnotation("video",!1,"BOOL"),$.stop()),d&&((0,ee.rt)("pin.id",O,"STRING"),(0,ee.rt)("video",!1,"BOOL"),(0,ee.Nx)(er.pM),(0,ee.l7)(er._z))},thumbnail:A})});case z.h8.MENTION_STICKER:return!C&&(0,p.jsx)(Z,{block:el({},r),elementType:12120,horizontalOffset:c,onFlyoutOpen:g,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:J,tooltipElementType:12121,verticalOffset:R,videoPinProgress:L});case z.h8.GENERIC_STICKER:return!C&&(t=5===(void 0===G?null:G),(0,p.jsx)(Z,{block:el({},r),elementType:t?12827:12858,horizontalOffset:c,onFlyoutOpen:g,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:J,tooltipElementType:t?12828:12859,verticalOffset:R,videoPinProgress:L}));case z.h8.PRODUCT_STICKER:return!C&&!s&&(0,p.jsx)(Z,{block:el({},r),elementType:12223,horizontalOffset:c,onFlyoutOpen:g,pageAspectRatio:x,pageIndex:S,pinKey:F,scaleFactor:J,tooltipElementType:12224,verticalOffset:R,videoPinProgress:L});case z.h8.VTO_MAKEUP_STICKER:return!C&&(0,p.jsx)(Z,{block:el({},r),elementType:12561,horizontalOffset:c,onFlyoutOpen:g,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:J,tooltipElementType:12561,verticalOffset:R,videoPinProgress:L});case z.h8.COMMENT_REPLY_STICKER:return r.type===z.h8.COMMENT_REPLY_STICKER&&!C&&(0,p.jsx)(f,{block:r,horizontalOffset:c,pageAspectRatio:x,scaleFactor:J,verticalOffset:R});default:return null}}},979904:function(e,t,n){n.d(t,{Z:function(){return f}});var r,i=n(586659);n(872555);var o=n(995415),l=n(934645),a=n(28427),s=n(906498),u=n(644493),c=n(664897),d=n(601686),p=(void 0!==r||(r=n(331047)).hash&&"b2a27d44d1f3dbd42301b82866212272"!==r.hash&&console.error("The definition of 'useCalculateMaxWidthAndHeightForSideBySideVariant_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function f(e){var t,n,r,f,h,y,m=e.pinKey,v=(0,d.x4)().closeupWithinMasonryEnabled,g=(0,c.Z)(),b=(0,a.Z)(p,m),_=(0,l.Z)({showProductDetailPage:!!(null!=b&&b.isEligibleForPdp)}),x=(0,s.Z)().group,P=(0,i.useMemo)(function(){var e;return null!=b&&b.carouselData?{carouselSlots:(null==(e=b.carouselData.carouselSlots)?void 0:e.map(function(e){return{domain:e.domain,link:e.link}}))||[],index:b.carouselData.index}:void 0},[null==b?void 0:b.carouselData]),S=(0,i.useMemo)(function(){return(0,o.Z)({carouselData:P,domain:null==b?void 0:b.domain})},[P,null==b?void 0:b.domain]).currentDomain,w=(0,i.useMemo)(function(){return S?S.split(".")[0]:""},[S]),j=(0,i.useMemo)(function(){var e=(null==b?void 0:b.trackedLink)||(null==b?void 0:b.link)||"",t=(0,u.Z)(e);return null!=t?t:e},[null==b?void 0:b.trackedLink,null==b?void 0:b.link]),O=(0,i.useMemo)(function(){var e,t,n,r,i,o,l,a=null==b||null==(e=b.richMetadata)||null==(t=e.products)?void 0:t[0],s=null==a?void 0:a.offerSummary,u=!!((null==s?void 0:s.price)||(null==s?void 0:s.standardPrice)),c=null==b||null==(n=b.linkDomain)||null==(r=n.officialUser)?void 0:r.firstName;return{hasPrice:u,domainOwner:!!(null==b||null==(i=b.closeupAttribution)?void 0:i.firstName)||!!c,merchantName:(null==b||null==(o=b.linkUserWebsite)||null==(l=o.officialUser)?void 0:l.firstName)||c||""}},[null==b||null==(t=b.richMetadata)?void 0:t.products,null==b||null==(n=b.linkDomain)||null==(r=n.officialUser)?void 0:r.firstName,null==b||null==(f=b.closeupAttribution)?void 0:f.firstName,null==b||null==(h=b.linkUserWebsite)||null==(y=h.officialUser)?void 0:y.firstName]),C=(0,i.useMemo)(function(){return!!((O.merchantName||w)&&j)},[O.merchantName,w,j]),k=(0,i.useMemo)(function(){var e,t=0,n=0;return e=84+(null!=b&&b.isEligibleForPdp&&O.hasPrice?18:0),t+=(null!=b&&b.closeupUnifiedTitle||null!=b&&b.gridTitle?23:0)+("enabled_idea_pin"!==x&&O.domainOwner?40:0),n+=64*!!C,e+=Math.max(t,n)},[null==b?void 0:b.isEligibleForPdp,O.hasPrice,null==b?void 0:b.closeupUnifiedTitle,null==b?void 0:b.gridTitle,x,O.domainOwner,C]);if(!v)return{maxHeight:void 0};if(g)return{maxHeight:_?void 0:"calc(round(100vh, 1px) - ".concat(80,"px - ").concat(k,"px)")};var I=Math.round(window.innerHeight)-80-k;return{maxHeight:_?void 0:I}}},11919:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var r=n(586659),i=n(341044),o=n(20256),l=n(707915),a=n(856782),s=n(111330),u=n(702849),c=n(19585),d=n(369416),p=n(753143),f=n(341742),h=n(664897),y=n(790427),m=n(382718);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=v(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t=e.containerRef,n=e.onAnimationEnd,i=e.startAnimating,l=e.containerWidth,a=(0,c.ZP)(),f=(0,h.Z)(),v=(0,p.M0)(),g=_((0,r.useState)(),2),x=g[0],P=g[1],S=_((0,r.useState)(!1),2),w=S[0],j=S[1],O=_((0,r.useState)(),2),C=O[0],k=O[1],I=a.bt("Share", "Share", "secondarySendButtonAnimation.share", undefined, true),E={buttonStyle:{animation:x,backgroundColor:u.Et},textStyle:{animation:C}};return(0,r.useEffect)(function(){if(!f&&l)if(i){j(!0);var e=(v.getItem(s.$M)||{animationSeenCount:0}).animationSeenCount;v.setItem(s.$M,{animationSeenCount:e+1,lastAnimationTimestamp:Date.now()}),P("buttonSlideOut 1s ease-in forwards"),k("textFadeIn 1s ease-in forwards")}else P("buttonSlideIn .3s ease-in forwards"),k("textFadeOut .3s ease-in-out forwards")},[l,v,i,f]),(0,m.jsxs)(r.Fragment,{children:[(0,m.jsx)(d.Z,{unsafeCSS:"\n@keyframes buttonSlideOut {\n  0% {\n    width: ".concat(48,"px;\n  }\n  15% {\n    width: ").concat(l,"px;\n  }\n  100% {\n    width: ").concat(l,"px;\n  }\n}\n\n@keyframes textFadeIn {\n  0% {\n    opacity: 0;\n  }\n  15% {\n    opacity: 0;\n  }\n  25% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes buttonSlideIn {\n  0% {\n    width: ").concat(l,"px;\n  }\n  100% {\n    width: ").concat(48,"px;\n  }\n}\n\n@keyframes textFadeOut {\n  0% {\n    opacity: 1;\n  }\n  15% {\n    opacity: 1;\n  }\n  25% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n")}),(0,m.jsx)(o.xu,{ref:t,alignItems:"center",dangerouslySetInlineStyle:{__style:b(b({},E.buttonStyle),{},{visibility:w?"visible":"hidden"})},display:"flex",onAnimationEnd:function(e){"buttonSlideIn"===e.animationName&&n()},position:"absolute",rounding:4,zIndex:y.mS,children:(0,m.jsxs)(o.kC,{alignItems:"center",gap:1,children:[(0,m.jsx)(o.xu,{padding:3,children:(0,m.jsx)(o.JO,{accessibilityLabel:I,color:"default",icon:"share",size:24})}),(0,m.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:E.textStyle},marginEnd:3,children:(0,m.jsx)(o.mg,{size:"md",children:I})})]})})]})}function S(e){var t=e.onAnimationEnd,n=(0,r.useRef)(null),i=_((0,r.useState)(0),2),o=i[0],l=i[1],s=_((0,r.useState)(!1),2),u=s[0],c=s[1];return(0,f.Z)(function(){var e=setTimeout(function(){c(!0);var e=setTimeout(function(){c(!1)},3e3);return function(){return clearTimeout(e)}},a.S+1e3);return function(){return clearTimeout(e)}}),(0,r.useEffect)(function(){if(n.current&&!o&&u){var e=n.current.getBoundingClientRect().width;e&&l(e)}},[n,o,u]),(0,m.jsx)(P,{containerRef:n,containerWidth:o,onAnimationEnd:t,startAnimating:u})}var w=n(121836),j=n(937392),O=n(675973),C=n(238589),k=n(807765),I=n(74229),E=n(539532);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach(function(t){M(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M(e,t,n){var r;return(r=function(e,t){if("object"!=A(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=A(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==A(r)?r:r+"")in e)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return z(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function V(e){var t=e.controllerOptions,n=e.iconColor,a=e.iconOnly,u=e.buttonText,d=e.showSendAnimation,h=void 0!==d&&d,y=e.tabIndex,v=void 0===y?0:y,g=e.closeupWithinMasonryEnabled,b=void 0!==g&&g,_=e.isInCloseupMediaViewer,x=void 0!==_&&_,P=(0,c.ZP)(),A=(0,p.M0)(),T=(0,C.Nl)(),z=(0,O.Z)().checkExperiment,V=(0,k.f)().setIsShowingShareButton,F=(0,r.useRef)(null),D=L((0,r.useState)(h),2),B=D[0],Z=D[1],W=x?new o.H3([I.k]):new o.Ry(5),H=L((0,r.useState)(function(){var e=T.getItem(w.bl)||0;return(A.getItem(s.$M)||{animationSeenCount:0}).animationSeenCount<2&&(2===e||3===e)}),1)[0],K=function(){Z(!1)};return(0,f.Z)(function(){var e=(A.getItem(s.$M)||{lastAnimationTimestamp:0}).lastAnimationTimestamp;(0,i.Z)(new Date(e),new Date)||A.setItem(s.$M,{animationSeenCount:0,lastAnimationTimestamp:e})}),(0,r.useEffect)(function(){return V(h),function(){V(!1)}},[V,h]),(0,m.jsxs)(r.Fragment,{children:[(0,m.jsx)(E.Z,R(R({},t),{},{children:function(e){var r=e.handleSendShareFlyoutButtonClick;return(0,m.jsxs)(o.u,{inline:!0,text:P.bt("Share", "Share", "Closeup.SharePin.Icon", undefined, true),zIndex:W,children:[B&&H&&z("sg_dweb_improved_share_animation_on_closeup").anyEnabled&&(0,m.jsx)(o.xu,{"data-test-id":"closeup-share-button",children:(0,m.jsx)(o.iP,{onTap:r,children:(0,m.jsx)(S,{onAnimationEnd:K})})}),x?(0,m.jsx)(o.zx,{ref:F,accessibilityLabel:P.bt("Share", "Share", "Closeup.SharePin.AccessibilityLabel", undefined, true),color:"semiTransparentWhite",iconEnd:"share",onClick:r,size:"lg",tabIndex:v,text:(0,m.jsx)(o.xv,{weight:"bold",children:P.bt("Share", "Share", "Closeup.SharePin.Button", undefined, true)})}):(0,m.jsx)(l.Z,{ref:F,accessibilityLabel:P.bt("Send", "Send", "Accessible label for button to send this pin", undefined, true),bgColor:b?"white":void 0,buttonText:u,handleClick:function(){return r()},icon:"share",iconColor:n,iconOnly:a,isActive:t.isFlyoutOpen,tabIndex:v,testId:"closeup-share-button"})]})}})),(0,m.jsx)(j.N,{anchors:M({},3017,F.current),idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0})]})}},869985:function(e,t,n){n.d(t,{Z:function(){return ec}});var r,i,o=n(586659);n(872555);var l=n(20256),a=n(592821),s=n(979904),u=n(890479),c=n(11919),d=n(980787),p=n(679422),f=n(28427),h=n(19585),y=n(601686),m=n(603316),v=n(382718);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){j(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(S=function(){return!!e})()}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t,n){return(t=O(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=g(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==g(t)?t:t+""}var C={__style:{backgroundColor:"#000"}},k=(void 0!==r||(r=n(307595)).hash&&"e04be51b4be0a2585e7803d004fa83b7"!==r.hash&&console.error("The definition of 'CloseupVideoEndCard_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),I=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&x(i,e);var t,n,r=(t=S(),function(){var e,n=w(i);return e=t?Reflect.construct(n,arguments,w(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==g(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return P(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return j(P(e=r.call.apply(r,[this].concat(n))),"handleRestartVideo",function(t){var n,r,i=t.event;i.stopPropagation(),null==(n=(r=e.props).onRestartVideo)||n.call(r,{event:i}),(0,m.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"restart",variant:"enabled_send_first"}})}),j(P(e),"handleShareVideo",function(){var t=e.props,n=t.clientTrackingParams,r=t.onToggleFlyout,i=t.isFlyoutOpen,o=t.pinId,l=t.requireAuth,a=t.logContextEvent;if(i&&(0,m.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}}),a({event_type:101,component:179,object_id_str:o,view_type:3,view_parameter:156,element:11731,clientTrackingParams:n}),l)return void l();r&&r()}),j(P(e),"handleExternalSend",function(){(0,m.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}})}),j(P(e),"renderReplayButton",function(){return(0,v.jsx)(l.iP,{accessibilityLabel:e.props.i18n.bt("Watch again", "Watch again", "Button when pressed restarts the video", undefined, true),onTap:e.handleRestartVideo,rounding:2,children:(0,v.jsxs)(l.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,v.jsx)(l.xu,{marginEnd:3,children:(0,v.jsx)(l.JO,{accessibilityLabel:e.props.i18n.bt("Watch again", "Watch again", "Button when pressed restarts the video", undefined, true),color:"inverse",icon:"refresh",size:18})}),(0,v.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:e.props.i18n.bt("Watch again", "Watch again", "Clickable label when pressed restarts the video", undefined, true)})]})})}),j(P(e),"renderShareButton",function(){var t=e.props,n=t.clientTrackingParams,r=t.gridDescription,i=t.imageSrc,o=t.isFlyoutOpen,a=t.onFlyoutDismiss,s=t.pinId;return(0,v.jsx)(l.iP,{accessibilityLabel:e.props.i18n.bt("Send", "Send", "end.video.send.icon.label", undefined, true),onTap:e.handleShareVideo,rounding:2,children:(0,v.jsxs)(l.xu,{alignItems:"center",display:"flex",justifyContent:"center",padding:2,children:[(0,v.jsx)(c.default,{controllerOptions:{flyoutDisplayOptions:{shownWithinMasonry:!0},loggingOptions:{component:179,element:72,onExternalSend:e.handleExternalSend,viewType:3},isFlyoutOpen:o,onFlyoutDismiss:a,onToggleFlyout:function(){},sendObject:{type:"pin",description:r,id:s,imageUrl:i,url:"/pin/".concat(s,"/"),clientTrackingParams:n}},iconColor:"white",iconOnly:!0,tabIndex:-1}),(0,v.jsx)(l.xu,{children:(0,v.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:e.props.i18n.bt("Send", "Send", "end.video.send.icon.label", undefined, true)})})]})})}),e}return n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.clientTrackingParams,n=e.pinId,r=e.logContextEvent;(0,m.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"land",variant:"enabled_send_first"}}),r({event_type:13,component:179,object_id_str:n,view_type:3,view_parameter:156,element:11731,clientTrackingParams:t})}},{key:"render",value:function(){var e=this.props,t=e.backgroundImage,n=e.naturalHeight,r=e.naturalWidth,i=e.maxHeight,o=e.maxWidth,a=e.pinTitle;return(0,v.jsx)(l.xu,{maxHeight:i,maxWidth:o,children:(0,v.jsxs)(l.Ee,{alt:a||"",naturalHeight:n,naturalWidth:r,src:t,children:[(0,v.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:C,left:!0,position:"absolute",right:!0,top:!0}),(0,v.jsx)(l.xu,{alignItems:"center",direction:"column",display:"flex",height:"100%",justifyContent:"center",left:!0,maxHeight:i,maxWidth:o,position:"absolute",top:!0,width:"100%",children:(0,v.jsxs)(l.xu,{position:"absolute",children:[(0,v.jsx)(l.xu,{children:this.renderShareButton()}),(0,v.jsx)(l.xu,{alignSelf:"center",children:this.renderReplayButton()})]})})]})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(o.PureComponent);function E(e){var t,n=e.pinKey,r=e.variant,i=(0,f.Z)(k,n),o=(0,d.u)().logContextEvent,l=(0,h.ZP)(),u=(0,p.Z)(),c=(0,y.x4)(),m=c.closeupWithinMasonryEnabled,g=c.peekCloseupEnabled,b=c.viewportSize,x=(0,a.Re)(),P=x.maxHeight,S=x.fiftyPercentHeight,w=x.fiftyPercentWidth,j=(0,s.Z)({pinKey:i}).maxHeight;return g?t="sm"===b?S:P:m&&(t=j),(0,v.jsx)(I,_(_({},e),{},{closeupWithinMasonryEnabled:m,i18n:l,logContextEvent:o,maxHeight:"media-viewer"===r?"inherit":t,maxWidth:"media-viewer"===r?"inherit":w,requireAuth:u}))}var A=function(e){var t=e.backgroundImage,n=e.onRestartVideo,r=e.pinTitle,i=(0,h.ZP)();return(0,v.jsx)(l.xu,{"data-test-id":"video-end-card",height:"100%",width:"100%",children:(0,v.jsxs)(l.Ee,{alt:r||"",fit:"contain",naturalHeight:1,naturalWidth:1,src:t,children:[(0,v.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:C,left:!0,opacity:.8,position:"absolute",right:!0,top:!0}),(0,v.jsx)(l.xu,{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",left:!0,position:"absolute",top:!0,width:"100%",children:(0,v.jsx)(l.xu,{children:(0,v.jsx)(l.iP,{onTap:n,rounding:2,children:(0,v.jsxs)(l.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,v.jsx)(l.hU,{accessibilityLabel:i.bt("Replay", "Replay", "closeupVideo.endCard.ReplayButton", undefined, true),icon:"refresh",iconColor:"white",size:"md"}),(0,v.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:i.bt("Replay", "Replay", "closeupVideo.endCard.ReplayButton", undefined, true)})]})})})})]})})},T=n(293565),R=n(392824),M=n(716920),L=n(361423),z=n(754545),V=n(956077),F=n(15667),D=n(281106),B=n(181663),Z=n(123317),W=n(724084),H=n(510928),K=n(647709),N=n(239728),U=n(104659),X=n(653621),q=n(589357),G=n(720445);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach(function(t){eo(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function et(e,t){return(et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function en(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function er(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(er=function(){return!!e})()}function ei(e){return(ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eo(e,t,n){return(t=el(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function el(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}var ea=(void 0!==i||(i=n(60533)).hash&&"53ae9ecd15f057f744460205e5d495fd"!==i.hash&&console.error("The definition of 'CloseupVideoNonDuplo_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),es=function(e,t){var n,r;t({currentTime:null!=(n=null==e?void 0:e.currentTime)?n:0,duration:null!=(r=null==e?void 0:e.duration)?r:1})},eu=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&et(i,e);var t,n,r=(t=er(),function(){var e,n=ei(i);return e=t?Reflect.construct(n,arguments,ei(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return en(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return eo(en(e=r.call.apply(r,[this].concat(n))),"state",{controls:"always"===e.props.showControls&&!e.props.disabled,fullscreen:!1,playing:!(0,T.G6)(e.props.requestContext.userAgent.browserName)&&!!e.props.autoplay&&!e.props.disabled,ready:!1,seeking:!1,showEndCard:!1,volume:e.props.muted||e.props.shouldMute?0:1,videoStartTime:e.props.videoStartTime||0}),eo(en(e),"setVideoPwtLoadingStop",function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(L.Z){var n=e.props,r=n.storyPinStepStopwatch,i=n.pinId;r&&(t||r.addAnnotation("video.startup.end"),r.addBinaryAnnotation("pin.id",i,"STRING"),r.addBinaryAnnotation("video",!0,"BOOL"),r.addBinaryAnnotation("preload",t,"BOOL"),r.addSubspan({name:"perceived_video_load",endTime:L.Z.now()}),r.stop()),t||(0,R.ZP)("video.startup.end"),(0,R.L8)("perceived_video_load"),(0,V.Nx)(X._z),(0,V.rt)("pin.id",i,"STRING"),(0,V.rt)("video",!0,"BOOL"),"STORY_PIN_CLOSEUP"===(0,z.Ly)()&&(0,V.l7)(X.pM)}}),eo(en(e),"componentDidMount",function(){var t=e.props,n=t.customThumbnail,r=t.video,i=t.preferMp4,o=r.mp4,l=r.hlsv3||r.hls||null,a=(i&&o||l||{}).thumbnail,s=(0,q.j4)(n||a);(null==s?void 0:s.ready)===4&&(e.setState({ready:!0}),e.props.autoplay&&e.setVideoPwtLoadingStop(!0)),document.addEventListener("fullscreenchange",e.onFullscreenChange),document.addEventListener("webkitfullscreenchange",e.onFullscreenChange),document.addEventListener("mozfullscreenchange",e.onFullscreenChange),document.addEventListener("MSFullscreenChange",e.onFullscreenChange)}),eo(en(e),"componentWillUnmount",function(){document.removeEventListener("fullscreenchange",e.onFullscreenChange),document.removeEventListener("webkitfullscreenchange",e.onFullscreenChange),document.removeEventListener("mozfullscreenchange",e.onFullscreenChange),document.removeEventListener("MSFullscreenChange",e.onFullscreenChange)}),eo(en(e),"onFullscreenChange",function(){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||e.props.setPanelOpen(function(e){return!e})}),eo(en(e),"componentDidUpdate",function(t,n){e.props.videoStartTime&&e.props.videoStartTime!==t.videoStartTime&&e.setState({videoStartTime:e.props.videoStartTime}),!1===t.isPlaying&&e.props.isPlaying&&e.setState({playing:!0,controls:"never"!==e.props.showControls}),t.isPlaying&&!1===e.props.isPlaying&&e.setState({playing:!1}),t.autoplay!==e.props.autoplay&&(e.setState({playing:!!e.props.autoplay}),e.props.autoplay&&e.state.ready&&e.setVideoPwtLoadingStop(!0)),t.muted!==e.props.muted&&e.setState({volume:+!e.props.muted}),"never"===e.props.showControls&&n.controls&&e.setState({controls:!1}),(n.controls||n.playing)&&e.props.disabled&&e.setState({playing:!1,controls:!1}),!n.playing&&e.state.playing&&e.props.onPlay&&e.props.onPlay(),e.props.isCloseupMediaViewerOpen&&!t.isCloseupMediaViewerOpen&&e.setState({playing:!1})}),eo(en(e),"handleTouch",function(){var t=e.state.seeking,n=e.props.disabled;t||n||e.setState(function(e){return{playing:!e.playing}})}),eo(en(e),"handleShowControls",function(){return e.setState({controls:!0})}),eo(en(e),"handleHideControls",function(){return e.setState({controls:!1})}),eo(en(e),"handleReady",function(){var t=e.state,n=t.ready,r=t.playing,i=e.props,o=i.autoplay,l=i.disabled;o&&!n&&e.setVideoPwtLoadingStop(),e.setState({ready:!0}),(0,T.G6)(e.props.requestContext.userAgent.browserName)&&!r&&o&&!l&&e.setState({playing:!0})}),eo(en(e),"handleEnded",function(t){var n=t.event,r=e.props,i=r.customThumbnail,o=r.customEndCard,l=r.pinId,a=r.setCurrentVideo,s=r.loop,u=r.onEnded;n.stopPropagation(),!s&&(e.setState({playing:!1}),i&&i.endsWith(".gif")||o||(e.setState({showEndCard:!0,videoStartTime:0}),a({pinId:l,isPromoted:!1,currentTime:0})),e.state.fullscreen&&e.exitFullscreen()),u&&u(),e.props.setPanelOpen(!0)}),eo(en(e),"handlePause",function(t){t.event.stopPropagation(),e.setState({playing:!1})}),eo(en(e),"handlePlay",function(t){t.event.stopPropagation(),e.setState({playing:!0})}),eo(en(e),"handleFullscreenChange",function(t){var n=t.event,r=t.fullscreen;n.stopPropagation(),e.setState({fullscreen:r})}),eo(en(e),"handlePlayheadDown",function(){e.setState({seeking:!0})}),eo(en(e),"handlePlayheadUp",function(){setTimeout(function(){e.setState({seeking:!1})},500)}),eo(en(e),"handleRestartVideo",function(t){t.event.stopPropagation(),e.setState({playing:!0,showEndCard:!1})}),eo(en(e),"handleShareRestartVideo",function(t){t.event.stopPropagation(),e.setState({playing:!0,showEndCard:!1})}),eo(en(e),"handleVolumeChange",function(t){var n=t.event,r=t.volume,i=e.props.shouldMute;n.stopPropagation(),i||e.setState({volume:r})}),eo(en(e),"exitFullscreen",function(){var e=window.document;(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement)&&(e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen())}),eo(en(e),"requestFullscreen",function(){var t=e.props,n=t.customThumbnail,r=t.video,i=t.preferMp4,o=r.mp4,l=r.hlsv3||r.hls||null,a=(i&&o||l||{}).thumbnail,s=(0,q.j4)(n||a);s.requestFullscreen?s.requestFullscreen():s.webkitRequestFullscreen?s.webkitRequestFullscreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen&&s.msRequestFullscreen()}),eo(en(e),"renderCloseupVideoEndCard",function(t,n,r,i){var o={backgroundImage:t,naturalHeight:n,naturalWidth:r,onRestartVideo:e.handleShareRestartVideo},l={backgroundImage:t,naturalHeight:n,naturalWidth:r,onRestartVideo:e.handleRestartVideo},a=e.props,s=a.clientTrackingParams,u=a.flyoutShareProps,c={clientTrackingParams:s,gridDescription:u?u.gridDescription:"",imageSrc:u?u.imageSrc:"",isFlyoutOpen:!!u&&u.isFlyoutOpen,onFlyoutDismiss:u?u.onFlyoutDismiss:function(){},onToggleFlyout:u?u.onToggleFlyout:function(){},pinId:u?u.pinId:"",pinKey:e.props.pin,variant:e.props.variant};return i?(0,v.jsx)(A,ee({},l)):(0,v.jsx)(E,ee(ee({},c),o))}),e}return n=[{key:"render",value:function(){var e=this,t=this.props,n=t.aspectRatio,r=t.autoplay,i=t.closeupStoryPinViewability,o=t.contextLogData,s=void 0===o?{component:179,is_closeup_video:!0,objectId:this.props.pinId,view:3,viewParameter:156}:o,c=t.customThumbnail,d=t.isPromoted,p=t.loop,f=t.objectFit,h=t.preferMp4,y=t.preload,m=t.requestContext,g=t.showControls,b=t.variant,_=t.video,x=t.captions,P=t.isDesktop,S=t.videoThumbnailStartTime,w=t.pin,j=t.pinId,O=t.setProgressInfo,C=t.progressInfo,k=t.setPanelOpen,I=t.panelOpen,E=t.setMute,A=t.isMuted,R=t.closeupWithinMasonryEnabled,M=t.maxHeight,L=t.maxWidth,z=t.onTimeChange,V=t.seekTime,F=t.roundingOverride;s.is_closeup_video=!0;var W=this.state,H=W.controls,K=W.fullscreen,U=W.playing,X=W.showEndCard,$=W.volume,J=W.videoStartTime,Y=_.hlsv3||_.hls||null;if(!Y&&!_.mp4)return null;var Q=_.mp4,et=h&&Q&&Q.url||Y&&[{type:"video/m3u8",src:Y.url}]||void 0,en=h&&Q||Y||{},er=en.height,ei=en.thumbnail,eo=en.width,el=c||ei;return(0,v.jsxs)(l.zd,{height:R||"media-viewer"===b?"inherit":void 0,rounding:F,wash:!R&&"media-viewer"!==b||void 0,width:R||"media-viewer"===b?"inherit":void 0,willChangeTransform:!((0,T.G6)(m.userAgent.browserName)&&K),children:[X?this.renderCloseupVideoEndCard(null!=el?el:"",null!=er?er:1,null!=eo?eo:1,d):(0,v.jsxs)(l.iP,{accessibilityLabel:this.props.i18n.bt("Pause or play video", "Pause or play video", "pin.closeup.video.tap", undefined, true),fullHeight:R||"media-viewer"===b,onMouseEnter:"hover"===g?this.handleShowControls:void 0,onMouseLeave:"hover"===g?this.handleHideControls:void 0,onTap:this.handleTouch,rounding:2,children:[(0,v.jsx)(D.Z,{playing:U,zIndexValue:99}),(0,v.jsx)(u.Z,{id:"VideoWithContextLogging",children:(0,v.jsx)(G.ZP,{aspectRatio:null!=n?n:(null!=eo?eo:1)/(null!=er?er:1),backgroundColor:R?"black":a.yc,captions:x,closeupStoryPinViewability:i,contextLogData:ee(ee({},s),{},{video_id:this.props.video.id}),hlsConfig:{startLevel:q.VS},isAutoPlay:!!r,loop:p,objectFit:f,onControlsPause:this.handlePause,onControlsPlay:this.handlePlay,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onPlay:function(){},onPlayError:function(){},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onReady:this.handleReady,onTimeChange:"storyPin"===b?z:function(e){var t=e.time;es&&"number"==typeof(null==Q?void 0:Q.duration)&&Q.duration>0&&O&&es({currentTime:t,duration:Q.duration/N.gJ},O)},onVolumeChange:this.handleVolumeChange,pin:w,pinKey:w,playing:U,poster:el,preferMp4:h,preload:y,seekTime:V,src:et,variant:b,video:h&&Q||Y||{},videoStartTime:J||S,volume:$})})]}),(0,v.jsx)(l.xu,{onMouseEnter:"hover"===g?this.handleShowControls:void 0,onMouseLeave:"hover"===g?this.handleHideControls:void 0,children:"storyPin"!==b&&(0,v.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:ee(ee({},H?ee({},q.Ul):{}),{},{flexDirection:"column-reverse"})},display:"flex",height:q.hy,maxHeight:M,maxWidth:L,paddingX:6,position:"absolute",width:"100%",zIndex:Z.Gf,children:(0,v.jsx)(u.Z,{id:"IdeaPinVideoScrubber",children:(0,v.jsx)(B.Z,{activePageIndex:0,captionsUrl:x,handleMute:function(){e.setState({volume:+!!A}),E(!A)},handlePanelChange:function(){k&&k(!I),I&&P&&e.requestFullscreen()},handlePause:function(){e.setState({playing:!1})},handlePausePlay:function(){e.setState({playing:!U})},handlePlay:function(){e.setState({playing:!0})},handleWatchAgain:this.handleRestartVideo,inMilliseconds:!1,isMuted:A,isPanelOpen:I,isPlaying:U,isStoryPin:!1,pageCount:1,pages:[],pinId:j,progressInfo:C,showEndCard:X,showVideoControls:H,viewParameter:156})})})})]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,el(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(o.Component);function ec(e){var t,n,r,i=e.pinKey,l=e.pinId,c=e.isPromoted,d=e.video,p=e.muted,m=e.variant,g=(0,f.Z)(ea,i),b=(0,h.ZP)(),_=(0,F.B)(),x=(0,M.g)(),P=(0,W.Hx)().seekTimes,S=(0,y.x4)(),w=S.clientTrackingParams,j=S.closeupWithinMasonryEnabled,O=S.isCloseupMediaViewerOpen,C=(0,a.Re)().maxWidth,k=(0,U.G)(),I=k.appUI,E=k.setCurrentVideo,A=I.videosAutoplaying,T=A.organicVideosAutoplaying,R=A.promotedVideosAutoplaying,L=_.locale.toLowerCase(),z=null!=(t=(null==(n=d.mp4)?void 0:n.captions_urls)||(null==(r=d.hlsv3)?void 0:r.captions_urls))?t:{},V=L&&z[L]||Object.values(z)[0]||"",D=(0,K.HG)(),B=c?R[l]:T[l],Z=parseInt((0,H.Z)().t||0,10),N=J((0,o.useState)((null==B?void 0:B.currentTime)||0),2),X=N[0],q=N[1],G=J((0,o.useState)(null),2),$=G[0],Y=G[1],Q=J((0,o.useState)(!0),2),et=Q[0],en=Q[1],er=J((0,o.useState)(p),2),ei=er[0],eo=er[1],el=(0,s.Z)({pinKey:g}).maxHeight;(0,o.useEffect)(function(){var e=X;Z>0&&(e=Z),P[l]&&(e=P[l]),q(e)},[P,l,Z,X]);var es=(0,o.useMemo)(function(){return("default"!==m||!O)&&(!B||!B.paused)},[m,B,O]);return(0,v.jsx)(u.Z,{id:"CloseupVideoInner",children:(0,v.jsx)(eu,ee(ee({},e),{},{captions:String(V)||"",clientTrackingParams:w,closeupWithinMasonryEnabled:j,i18n:b,isCloseupMediaViewerOpen:O,isDesktop:D,isMuted:ei,isPanelOpen:et,isPlaying:es,maxHeight:el,maxWidth:"media-viewer"===m?void 0:C,panelOpen:et,pin:g,progressInfo:$,requestContext:_,seekTime:P[l],setCurrentVideo:E,setMute:eo,setPanelOpen:en,setProgressInfo:Y,storyPinStepStopwatch:x,variant:m,videoStartTime:X}))})}eo(eu,"defaultProps",{loop:!1,showControls:"hover"})},974297:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){var t;return e&&null!=(t=[e["736x"],e["564x"],e["474x"],e["236x"]].find(function(e){return null==e?void 0:e.url}))?t:null}},291892:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(586659),i=n(284778),o=n(382718);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=["alt","children","color","elementTiming","fetchPriority","isActive","naturalHeight","naturalWidth","onLoad","src","fit","srcSet"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=l(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var c=function(e,t,n){var i=(0,r.useRef)(null),o=(0,r.useRef)(null);(0,r.useEffect)(function(){if(e!==i.current||n&&n!==o.current){i.current=null!=e?e:null;var r=document.querySelector('img[src="'.concat(e,'"]'))||null;null!=r&&r.complete&&t()}o.current=n},[e,t,n])};function d(e){var t=e.alt,n=e.children,r=e.color,l=e.elementTiming,s=e.fetchPriority,d=e.isActive,p=e.naturalHeight,f=e.naturalWidth,h=e.onLoad,y=e.src,m=e.fit,v=e.srcSet,g=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,a);return c(y,h,void 0!==d&&d),(0,o.jsx)(i.Z,u(u({},g),{},{alt:t,color:r,elementTiming:l,fetchPriority:s,fit:void 0===m?"none":m,naturalHeight:p,naturalWidth:f,onLoad:h,src:y,srcSet:v,children:n}))}},716920:function(e,t,n){n.d(t,{T:function(){return l},g:function(){return a}});var r=(0,n(658673).Z)({name:"story_pin_step",sampleRate:1}),i=r.Provider,o=r.get,l=i,a=o},281106:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(586659),i=n(20256),o=n(883817),l=n(369416),a=n(123317),s=n(382718);function u(e){var t=e.playing,n=e.zIndexValue;return(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)(l.Z,{unsafeCSS:"#story-pin-closeup-pause-play-overlay svg { filter: drop-shadow( 0px 0px 8px rgba(0,0,0,0.1));}"}),(0,s.jsx)(i.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"story-pin-closeup-pause-play-overlay",display:"flex",id:"story-pin-closeup-pause-play-overlay",justifyContent:"center",left:!0,opacity:.8,position:"absolute",right:!0,rounding:a.yR,top:!0,zIndex:n?new i.Ry(n):o.p8,children:!t&&(0,s.jsx)(i.JO,{accessibilityLabel:"Play",color:"light",icon:"play",size:48})})]})}},181663:function(e,t,n){n.d(t,{Z:function(){return b}});var r=n(586659),i=n(20256),o=n(19585),l=n(453179),a=n(579935),s=n(123317),u=n(724084),c=n(941404),d=n(572227),p=n(647709),f=n(239728),h=n(792171),y=n(601686),m=n(382718),v=function(){},g=function(e){var t=e.accessibilityLabel,n=e.dataTestId,r=e.disable,o=e.handleTap,l=e.icon;return(0,m.jsx)(i.xu,{"data-test-id":n,opacity:r?.5:void 0,children:(0,m.jsx)(i.iP,{disabled:r,onTap:o,children:(0,m.jsx)(i.JO,{accessibilityLabel:t,color:"light",icon:l,size:16})})})};function b(e){var t,n,b,_,x,P=e.activePageIndex,S=e.handlePanelChange,w=e.handlePlay,j=e.handlePause,O=e.handlePausePlay,C=e.handleMute,k=e.handleVideoScrubbingNewPage,I=e.handleWatchAgain,E=e.inMilliseconds,A=e.isPlaying,T=e.isMuted,R=e.isPanelOpen,M=e.pages,L=e.pageCount,z=e.pinId,V=void 0===z?"":z,F=e.progressInfo,D=e.showEndCard,B=e.showVideoControls,Z=void 0!==B&&B,W=e.viewParameter,H=e.isStoryPin,K=void 0===H||H,N=e.captionsUrl,U=(0,o.ZP)(),X=(F||{}).currentTime,q=(0,u.Hx)().seekTimes,G=(0,y.x4)().closeupWithinMasonryEnabled,$=(0,h.H)(),J=(0,p.HG)(),Y=$.captionsEnabled,Q=(0,d.Z)(),ee=M[P],et=(ee||T).should_mute,en=Object.keys(q).includes(V)&&q[V]?q[V]:X,er=(0,r.useMemo)(function(){return M.map(function(e){var t,n,r,i,o,a,s,u=null==(t=e.blocks)?void 0:t.find(function(e){return 3===e.block_type}),c=(null==u||null==(n=u.video)||null==(r=n.video_list)||null==(i=r.V_HLSV3_MOBILE)?void 0:i.duration)||(null==u||null==(o=u.video)||null==(a=o.video_list)||null==(s=a.V_720P)?void 0:s.duration);return c?{duration:c,isVideo:!0}:{duration:l.oN,isVideo:!1}})},[M]),ei=[{duration:(null==F?void 0:F.duration)||0,isVideo:!0}],eo=K?er:ei,el=null==(t=(ee&&(null==(_=ee.blocks)?void 0:_[0])||{}).video)||null==(n=t.video_list)||null==(b=n.V_HLSV3_MOBILE)?void 0:b.captions_urls,ea=!1;(el&&0!==Object.keys(el).length||(void 0===N?"":N))&&(ea=!0);var es=(0,r.useMemo)(function(){return eo.reduce(function(e,t){return e+(t.duration||0)},0)/(K?f.gJ:1)},[eo,K]),eu=(0,r.useMemo)(function(){return eo.filter(function(e,t){return t<P}).reduce(function(e,t){return e+(t.duration||0)},0)/f.gJ},[eo,P]),ec=eo.length>0&&null!=(x=eo[P])&&x.isVideo?null!=X?X:0:(null!=X?X:0)*5+(null!=eu?eu:0),ed=U.bt("Hide captions", "Hide captions", "gestalt.video.accessibilityHideCaptionsLabel", undefined, true),ep=U.bt("Show captions", "Show captions", "gestalt.video.accessibilityShowCaptionsLabel", undefined, true);return(0,m.jsxs)(i.xu,{alignContent:"evenly",alignItems:"baseline",dangerouslySetInlineStyle:{__style:{gap:"18.5px",pointerEvents:"auto"}},direction:"column",display:"flex",justifyContent:"between",width:"100%",children:[(0,m.jsxs)(i.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{opacity:Z||!A?1:0,transition:"all .1s"}},direction:"row",display:"flex",justifyContent:"between",width:"99%",children:[(0,m.jsxs)(i.kC,{alignItems:"center",direction:"row",gap:5,children:[(0,m.jsx)(g,{accessibilityLabel:A?U.bt("Pause", "Pause", "closeup.IdeaPinVideo.Pause", undefined, true):U.bt("Play", "Play", "closeup.IdeaPinVideo.Play", undefined, true),dataTestId:"story-pin-closeup-".concat(A?"pause":"play"),handleTap:D&&I?I:O,icon:A?"pause":"play"}),F&&(0,m.jsx)(i.iP,{children:(0,m.jsxs)(i.xu,{"aria-label":"".concat(U.bt("Video duration", "Video duration", "closeup.IdeaPinVideo.durationLabel", undefined, true),": ").concat((0,s.Lc)(ec)," of ").concat((0,s.Lc)(es)),"data-test-id":"time-display",children:[(0,m.jsx)(i.xv,{align:"end",color:"inverse",inline:!0,overflow:"normal",size:"300",weight:"bold",children:"".concat((0,s.Lc)(ec))})," ",(0,m.jsx)(i.xu,{display:"inlineBlock",opacity:.6,children:(0,m.jsx)(i.xv,{align:"end",color:"inverse",inline:!0,overflow:"normal",size:"300",weight:"bold",children:"/ ".concat((0,s.Lc)(es))})})]})})]}),(0,m.jsxs)(i.kC,{direction:"row",gap:5,children:[ea&&(0,m.jsx)(g,{accessibilityLabel:Y?ep:ed,dataTestId:"closed-captions-button-".concat(Y?"disable":"enable"),handleTap:function(){var e=J?"desktop_pin_page":"mweb_pin_page";Y?(0,c.My)("".concat(e,".closed_captions_button.toggle_off")):(0,c.My)("".concat(e,".closed_captions_button.toggle_on")),Q({action:"click",item:"closed-captions-button"}),$.setCaptionsEnabled(!Y)},icon:Y?"captions":"captions-outline"}),(0,m.jsx)(g,{accessibilityLabel:T?U.bt("Unmute", "Unmute", "closeup.IdeaPinVideo.unmute", undefined, true):U.bt("Mute", "Mute", "closeup.IdeaPinVideo.mute", undefined, true),dataTestId:"story-pin-closeup-".concat(T?"unmute":"mute"),disable:et,handleTap:C,icon:T?"mute":"sound"}),S&&!G&&(0,m.jsx)(g,{accessibilityLabel:R?U.bt("Maximise", "Maximize", "closeup.IdeaPinVideo.maximize", undefined, true):U.bt("Minimise", "Minimize", "closeup.IdeaPinVideo.minimize", undefined, true),dataTestId:"story-pin-closeup-".concat(R?"maximize":"minimize"),handleTap:S||v,icon:R?"maximize":"minimize"})]})]}),(0,m.jsx)(a.ZP,{activePageCurrentTime:en,activePageIndex:P,duration:es,handlePause:j,handlePlay:w,handleVideoScrubbingNewPage:k,inMilliseconds:E,isPlaying:A,pageCount:L,pageDurations:eo,pinId:V,progressInfo:F,shouldShowPlayhead:!0,showEndCard:D,showVideoControls:Z,videoDurations:eo,viewParameter:W})]})}},579935:function(e,t,n){n.d(t,{$:function(){return v},$E:function(){return m},ZP:function(){return x}});var r=n(586659),i=n(20256),o=n(521009),l=n(19585),a=n(453179),s=n(15667),u=n(382718);function c(e){var t=e.pillHeight,n=e.scrubberWidth;return(0,u.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:m}},display:"flex",flex:"grow",height:t,overflow:"hidden",rounding:"pill",children:(0,u.jsx)(i.xu,{color:v,dangerouslySetInlineStyle:{__style:{width:n}},"data-test-id":"video-progress-bar",height:"100%",rounding:"pill"})})}var d=n(724084),p=n(647709),f=n(239728);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var m="rgba(255,255,255,0.24)",v="light",g=function(){},b=function(e){var t=e.children,n=e.setHoveringChange,r=e.handleMouseDown,o=e.handleMouseLeave,a=e.handleTouchStart,s=e.playhead,c=e.isPlaying,d=e.showVideoControls,f=(0,l.ZP)(),h=!(0,p.HG)();return(0,u.jsx)(i.iP,{children:(0,u.jsx)(i.xu,{ref:s,alignItems:"center","aria-label":f.bt("Video scrubber progress bar", "Video scrubber progress bar", "ideaPin.closeupvideo.videoScrubberLabel", undefined, true),dangerouslySetInlineStyle:{__style:{pointerEvents:"auto",touchAction:"none"}},"data-test-id":"bullet-video-progress-bar",display:"flex",flex:"grow",justifyContent:h?"center":"start",marginBottom:6*!h,minHeight:"8px",onFocus:n(!0),onMouseDown:r,onMouseLeave:o,onMouseOver:n(!0),onTouchEnd:function(e){return e.preventDefault()},onTouchStart:a,opacity:d||!c?1:0,paddingY:6*!!h,position:"relative",role:"progressbar",width:"100%",children:t})})},_=function(e){var t=e.isRTL,n=e.isSeeking,r=e.scrubberWidth;return(0,u.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:t?{right:r}:{left:r}},"data-test-id":"video-progress-bar-playhead",position:"relative",children:(0,u.jsx)(i.xu,{color:v,height:4,position:"absolute",rounding:"pill",children:(0,u.jsx)(i.xu,{color:"light",dangerouslySetInlineStyle:{__style:{marginTop:n?-8:-6}},height:n?16:12,marginStart:-2,rounding:"circle",width:n?16:12})})})};function x(e){var t=e.activePageIndex,n=e.activePageCurrentTime,l=e.pageCount,y=e.progressInfo,m=e.showEndCard,x=e.duration,P=void 0===x?0:x,S=e.pageDurations,w=void 0===S?[]:S,j=e.handlePlay,O=void 0===j?g:j,C=e.handlePause,k=void 0===C?g:C,I=e.handleVideoScrubbingNewPage,E=void 0===I?g:I,A=e.inMilliseconds,T=e.videoDurations,R=void 0===T?[]:T,M=e.viewParameter,L=e.isInactiveStreamPin,z=void 0!==L&&L,V=e.isPlaying,F=void 0!==V&&V,D=e.setVideoProgress,B=e.shouldShowPlayhead,Z=void 0!==B&&B,W=e.showVideoControls,H=void 0===W||W,K=e.pinId,N=void 0===K?"":K,U=!(0,p.HG)(),X=(0,r.useRef)(null),q=(0,s.B)().isRTL,G=h((0,r.useState)(!1),2),$=G[0],J=G[1],Y=h((0,r.useState)(F),2),Q=Y[0],ee=Y[1],et=h((0,r.useState)(),2),en=et[0],er=et[1],ei=(0,o.Z)(),eo=h((0,r.useState)(!1),2),el=eo[0],ea=eo[1],es=(0,d.RC)(),eu=es.clearSeekTime,ec=es.updateSeekTime,ed=(0,r.useCallback)(function(e,n){if(!z&&n<=l){if(n!==t&&E(n),D){var r,i;D({currentTime:e/1e3,duration:R[n].isVideo?null!=(r=null==y?void 0:y.duration)?r:1:null!=(i=null==y?void 0:y.duration)?i:5,pinId:N})}ec(e/1e3,N)}ei({event_type:101,view_type:3,view_parameter:M,component:14302})},[t,E,z,ei,l,N,null==y?void 0:y.duration,D,ec,R,M]),ep=w.map(function(e){return"".concat((e.duration||0)/P/10,"%")}),ef=(0,r.useMemo)(function(){var e=0;return w.map(function(t){var n=t.duration+e,r={min:e,max:n};return e=n,r})},[w]),eh=$?"0 1.2px":"0 1px",ey=function(e){return function(){return J(e)}},em=(0,r.useCallback)(function(e){if(X.current){var t=X.current.getBoundingClientRect(),n=t.left,r=t.right,i=t.width,o=void 0===i?0:i,l=(q?Math.max(0,Math.min(((void 0===r?0:r)-e)/o,1)):Math.max(0,Math.min((e-(void 0===n?0:n))/o,1)))*P*1e3,a=ef.findIndex(function(e){return l>=e.min&&l<=e.max}),s=-1===a?0:a;ed(l-ef[s].min,s)}},[P,ed,ef,q]),ev=(0,r.useCallback)(function(){el||ee(F||m),ea(!0)},[el,ee,F,m]),eg=(0,r.useCallback)(function(e){ev(),F&&k(),em(e.pageX)},[ev,F,k,em]),eb=(0,r.useCallback)(function(e){el&&em(e.pageX)},[em,el]),e_=(0,r.useCallback)(function(e){if(el){e.preventDefault();var t=Array.from(e.changedTouches).find(function(e){return e.identifier===en});t&&em(t.pageX)}},[el,em,en]),ex=(0,r.useCallback)(function(){ey(!1),er(void 0),ea(!1),Q&&O()},[O,Q]),eP=(0,r.useCallback)(function(e){Array.from(e.changedTouches).find(function(e){return e.identifier===en})&&(ey(!1),er(void 0),ea(!1),eu()),Q&&O()},[eu,O,Q,en]);return(0,r.useEffect)(function(){return el&&!z&&(window.addEventListener("mousemove",eb),window.addEventListener("mouseup",ex),window.addEventListener("touchmove",e_),window.addEventListener("touchend",eP)),function(){window.removeEventListener("mousemove",eb),window.removeEventListener("mouseup",ex),window.removeEventListener("touchmove",e_),window.removeEventListener("touchend",eP)}},[eb,ex,eP,e_,z,el,em,Q,en]),(0,u.jsx)(b,{handleMouseDown:eg,handleMouseLeave:function(){ey(!1)},handleTouchStart:function(e){ev(),ey(!0);var t=e.changedTouches[0];er(t.identifier),em(t.pageX)},isPlaying:F,playhead:X,setHoveringChange:ey,showVideoControls:H,children:Array(l).fill(void 0).map(function(e,r){var o,s,d=null!=(o=null==y?void 0:y.currentTime)?o:0,p=null!=(s=null==y?void 0:y.duration)?s:a.P6,h=R[r],g="".concat(null!=h&&h.isVideo&&A?Math.floor(1e4*(null!=n?n:d)/(h.duration/f.gJ))/100:d/p*100,"%");return(0,u.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{margin:eh}},flex:"grow",width:ep.length===l?ep[r]:"auto",children:(0,u.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{transition:"all .1s"}},"data-test-id":"idea-pin-video-progress-bar",rounding:"pill",children:r<t||m?(0,u.jsx)(i.xu,{color:v,height:4,rounding:"pill"}):t===r&&y?(0,u.jsxs)(i.kC,{alignItems:"center",flex:"grow",children:[Z&&(H||$||el||U)&&(0,u.jsx)(_,{isRTL:q,isSeeking:el,scrubberWidth:g}),(0,u.jsx)(c,{pillHeight:4,scrubberWidth:g})]}):(0,u.jsx)(i.xu,{color:v,dangerouslySetInlineStyle:{__style:{opacity:.24}},height:4,rounding:"pill"})})},"".concat(N,"-").concat(r))})})}},294711:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){var t=e.currentTime,n=e.endTime,r=e.startTime;return"number"!=typeof r||"number"!=typeof n||!(r>=0)||!(n>0)||!(r<n)||r<=t&&t<=n}},399806:function(e,t,n){n.d(t,{Q:function(){return o},Z:function(){return l}});var r=["vHLSV3MOBILE"],i=function(){var e;return!(null!=(e=window)&&e.devicePixelRatio)||window.devicePixelRatio<=1?"1x":"2x"},o=function(){var e,t,n,r="undefined"!=typeof window?null==(e=window.navigator)||null==(t=e.connection)?void 0:t.effectiveType:void 0,o=i();return r?"4g"===r?n="40-80":(o="1x",n="0-1"):n="unknown",{downloadSpeedGroup:n,screenDimension:o}};function l(e){var t,n,i,l,a,s,u,c,d,p,f,h,y=e.vHLSV3MOBILE,m=(n=(t=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,r)).vEXP3,i=t.vEXP4,l=t.vEXP5,a=t.vEXP6,s=t.vEXP7,u=t.v720P,d=(c=o()).downloadSpeedGroup,p=c.screenDimension,({unknown:f={"1x":n,"2x":l},"0-1":f,"1-5":{"1x":i,"2x":l},"5-10":{"1x":l,"2x":l},"10-20":{"1x":a,"2x":a},"20-40":h={"1x":s,"2x":s},"40-80":h,"80_or_above":h})[d][p]||u||void 0),v=y||void 0;return m?{hlsv3:v,mp4:m}:{hlsv3:v}}},807765:function(e,t,n){n.d(t,{c:function(){return d},f:function(){return c}});var r=n(586659),i=n(729434),o=n(382718);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var s=(0,i.Z)("CloseupAnimations"),u=s.Provider,c=s.get;function d(e){var t=e.children,n=l((0,r.useState)(!1),2),i=n[0],a=n[1],s=l((0,r.useState)(!1),2),c=s[0],d=s[1],p=(0,r.useMemo)(function(){return{isShowingShareButton:i,setIsShowingShareButton:a,isShowingVisualSearchButton:c,setIsShowingVisualSearchButton:d}},[i,c]);return(0,o.jsx)(u,{value:p,children:t})}},218831:function(e,t,n){n.d(t,{C:function(){return u},K:function(){return s}});var r=n(586659),i=n(382718);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,l,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a=(0,r.createContext)({closeupBodyWidth:0,isCollageOverlayOpen:!1,isRelatedPins10PercentVisible:!1,setCloseupBodyWidth:function(){},setIsCollageOverlayOpen:function(){},setIsRelatedPins10PercentVisible:function(){}});function s(){var e=(0,r.useContext)(a);if(!e)throw Error("useCloseupBodyContext must be used within CloseupBodyContextProvider");return e}function u(e){var t=e.children,n=o((0,r.useState)(0),2),l=n[0],s=n[1],u=o((0,r.useState)(!1),2),c=u[0],d=u[1],p=o((0,r.useState)(!1),2),f=p[0],h=p[1],y=(0,r.useMemo)(function(){return{closeupBodyWidth:l,setCloseupBodyWidth:s,isCollageOverlayOpen:c,setIsCollageOverlayOpen:d,isRelatedPins10PercentVisible:f,setIsRelatedPins10PercentVisible:h}},[l,c,f]);return(0,i.jsx)(a,{value:y,children:t})}},85574:function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){var i,o;i=t,o=n[t],(i=function(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}(i))in e?Object.defineProperty(e,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[i]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{Z:function(){return h}});var l={WebkitMaskImage:"-webkit-radial-gradient(white, black)"},a=function(e){return"".concat(null!=e?e:0,"px")},s=function(e){var t=e.topLeft,n=e.topRight,r=e.bottomRight,i=e.bottomLeft;return"".concat(a(t)," ").concat(a(n)," ").concat(a(r)," ").concat(a(i))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.additionalPadding,n=void 0===t?0:t;return{borderRadius:s({topLeft:32+n,topRight:32+n,bottomRight:0,bottomLeft:0}),borderRadiusNumeric:32+n}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.additionalPadding,n=void 0===t?0:t;return{borderRadius:s({topLeft:24+n,topRight:24+n,bottomRight:24+n,bottomLeft:24+n}),borderRadiusNumeric:24+n}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.additionalPadding,n=void 0===t?0:t;return{borderRadius:s({topLeft:32+n,topRight:0,bottomRight:0,bottomLeft:32+n}),borderRadiusNumeric:32+n}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.additionalPadding,n=void 0===t?0:t;return{borderRadius:s({topLeft:0,topRight:32+n,bottomRight:32+n,bottomLeft:0}),borderRadiusNumeric:32+n}},f=function(e){var t=e.getterOptions,n=e.isPadded,r=e.isRTL;return n?c(t):r?p(t):d(t)};function h(e){var t=e.additionalPadding,n=e.isSideBySide,r=e.isPadded,i=e.isRTL,a=e.closeupWithinMasonryEnabled,s=e.peekCloseupEnabled,d={additionalPadding:t};if(void 0!==a&&a)return{borderStyle:o(o({},l),{},{borderRadius:"".concat(24,"px")}),borderRadiusNumeric:24};if(void 0!==s&&s)return{borderStyle:o(o({},l),{},{borderRadius:"unset"}),borderRadiusNumeric:0};if(n){var p=f({isPadded:r,isRTL:i,getterOptions:d}),h=p.borderRadius,y=p.borderRadiusNumeric;return{borderStyle:o(o({},l),{},{borderRadius:h}),borderRadiusNumeric:y}}var m=(r?c:u)(d),v=m.borderRadius,g=m.borderRadiusNumeric;return{borderStyle:o(o({},l),{},{borderRadius:v}),borderRadiusNumeric:g}}},653621:function(e,t,n){function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,void 0):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{GL:function(){return s},_z:function(){return l},d0:function(){return c},hO:function(){return u},pM:function(){return a}});var o,l="video",a="image",s=new Map([["DEFAULT",new Set(["button"])],["story_pin",new Set([l])],["product_detail_page",new Set(["description","shopButton","thumbnailsLoaded"])],["product_detail_page_plus",new Set(["description","shopButton","thumbnailsLoaded"])]]),u=(o=new Set,s.forEach(function(e){o=new Set([].concat(r(o),r(e)))}),o),c=new Set([].concat(r(u),[a,"resource"]))},452750:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(640785);function i(e){var t;return{defaultStyle:0,fontFamily:null!=(t=e.name)?t:"",fontGroup:r.gu,fontOverrides:{letterSpacing:e.letter_spacing,lineHeight:e.line_height},format:"truetype",id:e.id,styles:[{fontStyle:"",fontUrl:e.url,fontWeight:"normal",name:"normal"}]}}},341044:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(654262),i=n(947631);function o(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(e),o=(0,r.Z)(t);return n.getTime()===o.getTime()}}}]);